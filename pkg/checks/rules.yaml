- id: "CIS-5.1.1"
  title: "Disable root login over SSH"
  category: "Auth"
  fact: "ssh.permit_root_login"
  expected: "no"
  severity: "High"
  remediation: "Set 'PermitRootLogin no' in /etc/ssh/sshd_config and reload sshd."
  tags: ["cis","ssh"]

- id: "CIS-1.1.2.2-devshm"
  title: "/dev/shm mounted with nodev,nosuid,noexec"
  category: "FS_Perms"
  fact: "mount.devshm_options"
  expected_allof: ["nodev","nosuid","noexec"]
  severity: "High"
  remediation: "Ensure /dev/shm has nodev,nosuid,noexec (fstab or systemd mount)."
  tags: ["cis","fs"]

- id: "CIS-3.3.1"
  title: "IPv6 redirects disabled (all)"
  category: "Services"
  fact: "sysctl.net.ipv6.conf.all.accept_redirects"
  expected: "0"
  severity: "Medium"
  remediation: "Set net.ipv6.conf.all.accept_redirects=0 and persist in sysctl.conf."
  tags: ["cis","net"]
- id: "CIS-4.1.1"
  title: "firewalld installed"
  category: "Services"
  fact: "pkg.firewalld_installed"
  expected: "present"
  severity: "High"
  remediation: "Install firewalld and enable the service."
  tags: ["cis","services"]

- id: "CIS-4.1.2"
  title: "firewalld enabled and active"
  category: "Services"
  fact: "svc.firewalld_state"
  expected: "enabled_active"
  severity: "High"
  remediation: "systemctl enable --now firewalld"
  tags: ["cis","services"]

- id: "CIS-1.6.1"
  title: "Crypto policy not LEGACY"
  category: "Auth"
  fact: "crypto.policy"
  expected: "NOT_LEGACY"
  severity: "Medium"
  remediation: "Use `update-crypto-policies --set DEFAULT` (or higher), avoid LEGACY."
  tags: ["cis","crypto"]
- id: "CIS-1.1.2.2-tmp"
  title: "/tmp mounted with nodev,nosuid,noexec"
  category: "FS_Perms"
  fact: "mount.tmp_options"
  expected_allof: ["nodev","nosuid","noexec"]
  severity: "High"
  remediation: "Ensure /tmp has nodev,nosuid,noexec (fstab or systemd tmp.mount)."
  tags: ["cis","fs"]

- id: "CIS-1.1.2.2-vartmp"
  title: "/var/tmp mounted with nodev,nosuid,noexec"
  category: "FS_Perms"
  fact: "mount.vartmp_options"
  expected_allof: ["nodev","nosuid","noexec"]
  severity: "High"
  remediation: "Ensure /var/tmp has nodev,nosuid,noexec."
  tags: ["cis","fs"]
- id: "CIS-5.2.2"
  title: "sudo uses pty"
  category: "Privileges"
  fact: "sudo.use_pty"
  expected: "true"
  severity: "High"
  remediation: "Add 'Defaults use_pty' in sudoers."
  tags: ["cis","sudo"]

- id: "CIS-5.2.3"
  title: "sudo has logfile"
  category: "Privileges"
  fact: "sudo.logfile"
  expected: "true"
  severity: "Medium"
  remediation: "Add 'Defaults logfile=\"/var/log/sudo.log\"' in sudoers."
  tags: ["cis","sudo"]

- id: "CIS-5.4.1"
  title: "Only root has UID 0"
  category: "Privileges"
  fact: "acct.uid0_unique"
  expected: "true"
  severity: "Critical"
  remediation: "Ensure only root has UID 0."
  tags: ["cis","accounts"]
# --- SSH extras
- id: "CIS-5.1.6"
  title: "X11Forwarding disabled"
  category: "Auth"
  fact: "ssh.x11_forwarding"
  expected: "no"
  severity: "Low"
  remediation: "Set 'X11Forwarding no' in /etc/ssh/sshd_config and reload sshd."
  tags: ["cis","ssh"]

- id: "CIS-5.1.14"
  title: "SSH Banner configured"
  category: "Auth"
  fact: "ssh.banner"
  expected: "present"
  severity: "Low"
  remediation: "Set 'Banner /etc/issue.net' (or similar) and reload sshd."
  tags: ["cis","ssh"]

# --- Sysctl (IPv6/IPv4)
- id: "CIS-3.3.3"
  title: "IPv6 accept_ra disabled (all)"
  category: "Services"
  fact: "sysctl.net.ipv6.conf.all.accept_ra"
  expected: "0"
  severity: "Medium"
  remediation: "Set net.ipv6.conf.all.accept_ra=0 and persist."
  tags: ["cis","net"]

- id: "CIS-3.3.5"
  title: "IPv6 accept_source_route disabled (all)"
  category: "Services"
  fact: "sysctl.net.ipv6.conf.all.accept_source_route"
  expected: "0"
  severity: "Medium"
  remediation: "Set net.ipv6.conf.all.accept_source_route=0 and persist."
  tags: ["cis","net"]

- id: "CIS-3.2.1"
  title: "TCP SYN cookies enabled"
  category: "Services"
  fact: "sysctl.net.ipv4.tcp_syncookies"
  expected: "1"
  severity: "Medium"
  remediation: "Set net.ipv4.tcp_syncookies=1 and persist."
  tags: ["cis","net"]

# --- Sudo hardening
- id: "CIS-5.2.4"
  title: "sudo timestamp_timeout is sane (<=15)"
  category: "Privileges"
  fact: "sudo.timestamp_timeout_sane"
  expected: "true"
  severity: "Medium"
  remediation: "Set 'Defaults timestamp_timeout=15' (or lower)."
  tags: ["cis","sudo"]

- id: "CIS-5.2.5"
  title: "No NOPASSWD wildcards in sudoers"
  category: "Privileges"
  fact: "sudo.nopasswd_wildcard_forbidden"
  expected: "true"
  severity: "High"
  remediation: "Remove 'NOPASSWD' with wildcard commands; require authentication."
  tags: ["cis","sudo"]

# --- Authselect / PAM presence (simple v1 check)
- id: "CIS-5.3.1"
  title: "PAM pwquality present"
  category: "Auth"
  fact: "pam.pwquality_present"
  expected: "true"
  severity: "High"
  remediation: "Ensure pam_pwquality.so is configured in system-auth/password-auth (via authselect)."
  tags: ["cis","pam"]

- id: "CIS-5.3.2"
  title: "PAM pwhistory present"
  category: "Auth"
  fact: "pam.pwhistory_present"
  expected: "true"
  severity: "High"
  remediation: "Ensure pam_pwhistory.so is configured in system-auth/password-auth (via authselect)."
  tags: ["cis","pam"]

- id: "CIS-5.3.3"
  title: "PAM faillock present"
  category: "Auth"
  fact: "pam.faillock_present"
  expected: "true"
  severity: "High"
  remediation: "Ensure pam_faillock.so is configured in system-auth/password-auth (via authselect)."
  tags: ["cis","pam"]
# --- Sysctl (IPv6/IPv4 defaults)
- id: "CIS-3.3.2"
  title: "IPv6 redirects disabled (default)"
  category: "Services"
  fact: "sysctl.net.ipv6.conf.default.accept_redirects"
  expected: "0"
  severity: "Medium"
  remediation: "Set net.ipv6.conf.default.accept_redirects=0 and persist."
  tags: ["cis","net"]

- id: "CIS-3.3.4"
  title: "IPv6 accept_ra disabled (default)"
  category: "Services"
  fact: "sysctl.net.ipv6.conf.default.accept_ra"
  expected: "0"
  severity: "Medium"
  remediation: "Set net.ipv6.conf.default.accept_ra=0 and persist."
  tags: ["cis","net"]

- id: "CIS-3.3.6"
  title: "IPv6 accept_source_route disabled (default)"
  category: "Services"
  fact: "sysctl.net.ipv6.conf.default.accept_source_route"
  expected: "0"
  severity: "Medium"
  remediation: "Set net.ipv6.conf.default.accept_source_route=0 and persist."
  tags: ["cis","net"]

# --- Accounts / password policy (login.defs)
- id: "CIS-5.4.2"
  title: "PASS_MAX_DAYS <= 365"
  category: "Auth"
  fact: "login.defs.pass_max_days_ok"
  expected: "true"
  severity: "Medium"
  remediation: "Set PASS_MAX_DAYS 365 (or lower) in /etc/login.defs."
  tags: ["cis","accounts"]

- id: "CIS-5.4.3"
  title: "PASS_MIN_DAYS >= 1"
  category: "Auth"
  fact: "login.defs.pass_min_days_ok"
  expected: "true"
  severity: "Low"
  remediation: "Set PASS_MIN_DAYS 1 (or higher) in /etc/login.defs."
  tags: ["cis","accounts"]

- id: "CIS-5.4.4"
  title: "PASS_WARN_AGE >= 7"
  category: "Auth"
  fact: "login.defs.pass_warn_age_ok"
  expected: "true"
  severity: "Low"
  remediation: "Set PASS_WARN_AGE 7 (or higher) in /etc/login.defs."
  tags: ["cis","accounts"]

# --- Account inactivity lock (defaults)
- id: "CIS-5.4.5"
  title: "Default INACTIVE <= 30 days"
  category: "Auth"
  fact: "useradd.inactive_ok"
  expected: "true"
  severity: "Medium"
  remediation: "Set `useradd -D -f 30` to enforce default inactive lock."
  tags: ["cis","accounts"]

